<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile - Chronos Timepieces</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        .profile-container {
            max-width: 1000px;
            margin: 150px auto 100px;
            padding: 0 20px;
        }
        .profile-header {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(212,175,55,0.2);
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .profile-info h2 { color: var(--gold); margin-bottom: 0.5rem; }
        .profile-info p { opacity: 0.7; }
        .profile-grid { display: grid; gap: 2rem; grid-template-columns: 1fr 1fr; }
        .profile-card {
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.1);
            padding: 2rem;
            border-radius: 12px;
        }
        .profile-card h3 { color: var(--gold); margin-bottom: 1.5rem; }
        .stat-item { display: flex; justify-content: space-between; padding: 1rem 0; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .stat-label { opacity: 0.7; }
        .stat-value { font-weight: 700; color: var(--gold); }
        .order-item { padding: 1rem 0; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .order-item:last-child { border-bottom: none; }
        .order-header { display: flex; justify-content: space-between; margin-bottom: 0.5rem; }
        .order-id { font-weight: 600; }
        .order-status { padding: 4px 8px; border-radius: 4px; font-size: 0.85rem; }
        .status-pending { background: #ffd700; color: black; }
        .status-completed { background: #4CAF50; color: white; }
        @media (max-width: 768px) {
            .profile-grid { grid-template-columns: 1fr; }
            .profile-header { flex-direction: column; text-align: center; gap: 1rem; }
        }
    </style>
</head>
<body>
    <nav class="navbar" id="navbar">
        <div class="nav-top">
            <div class="container">
                <a href="index.html" class="logo-container">
                    <img src="assets/logo/chronos-logo.jpg" alt="Chronos Icon" class="logo-icon">
                    <div class="logo-text">
                        <div class="logo-brand">Chronos Timepieces</div>
                        <div class="logo-tagline">Where Time Meets Elegance</div>
                    </div>
                </a>
                <div class="nav-right-section">
                    <div class="nav-actions">
                        <button class="nav-icon-btn" id="accountBtn" aria-label="Account">
                            <span class="nav-icon-label">Login</span>
                        </button>
                        <button class="nav-icon-btn" id="wishlistNavBtn" aria-label="Wishlist" onclick="window.location.href='wishlist.html'">
                            <span class="nav-icon-label">Wishlist</span>
                        </button>
                        <button class="nav-icon-btn" id="cartBtn" aria-label="Cart">
                            <div class="cart-count">0</div>
                            <span class="nav-icon-label">Cart</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="profile-container">
        <div class="profile-header">
            <div class="profile-info">
                <h2 id="userName">Loading...</h2>
                <p id="userEmail">user@example.com</p>
            </div>
            <button class="btn btn-outline" onclick="logout()">Logout</button>
        </div>

        <div class="profile-grid">
            <div class="profile-card">
                <h3>Account Summary</h3>
                <div class="stat-item">
                    <span class="stat-label">Cart Items</span>
                    <span class="stat-value" id="cartItemCount">0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Cart Total</span>
                    <span class="stat-value" id="cartTotal">৳0</span>
                </div>
                <div class="stat-item">
                    <span class="stat-label">Total Orders</span>
                    <span class="stat-value" id="orderCount">0</span>
                </div>
                <a href="cart.html" class="btn btn-primary" style="margin-top: 1.5rem; width: 100%; text-align: center; display: block; text-decoration: none;">View Cart</a>
                <a href="wishlist.html" class="btn btn-outline" style="margin-top: 1rem; width: 100%; text-align: center; display: block; text-decoration: none;">My Wishlist</a>
            </div>

            <div class="profile-card">
                <h3>Recent Orders</h3>
                <div id="ordersList">
                    <p style="opacity: 0.5; text-align: center; padding: 2rem 0;">No orders yet</p>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import { supabase } from './supabase-config.js'
        
        document.addEventListener('DOMContentLoaded', async () => {
            // Check Supabase auth
            const { data: { session } } = await supabase.auth.getSession()
            
            if (!session?.user) {
                window.location.href = 'login.html';
                return;
            }
            
            const user = session.user
            
            // Display user info
            document.getElementById('userName').textContent = user.email?.split('@')[0] || 'User';
            document.getElementById('userEmail').textContent = user.email || '';
            
            // Load cart summary
            const cart = JSON.parse(localStorage.getItem('cart') || '[]');
            const cartCount = cart.reduce((sum, item) => sum + item.quantity, 0);
            const cartTotal = cart.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            
            document.getElementById('cartItemCount').textContent = cartCount;
            document.getElementById('cartTotal').textContent = `৳${cartTotal.toLocaleString()}`;
            
            // Load orders from Supabase
            loadOrders();
        });
        
        async function loadOrders() {
            try {
                const { data: orders, error } = await supabase
                    .from('orders')
                    .select('*')
                    .order('created_at', { ascending: false })
                
                if (error) throw error
                
                document.getElementById('orderCount').textContent = orders?.length || 0;
                
                const ordersList = document.getElementById('ordersList');
                if (orders && orders.length > 0) {
                    ordersList.innerHTML = orders.slice(0, 5).map(order => `
                        <div class="order-item">
                            <div class="order-header">
                                <span class="order-id">Order #${order.id}</span>
                                <span class="order-status ${order.status === 'pending' ? 'status-pending' : 'status-completed'}">${order.status}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; opacity: 0.7; font-size: 0.9rem;">
                                <span>${new Date(order.created_at).toLocaleDateString()}</span>
                                <span>৳${order.total.toLocaleString()}</span>
                            </div>
                        </div>
                    `).join('');
                }
            } catch (err) {
                console.error('Error loading orders:', err);
            }
        }
        
        window.logout = async function() {
            if (confirm('Are you sure you want to logout?')) {
                const { error } = await supabase.auth.signOut()
                if (!error) {
                    window.location.href = 'index.html';
                }
            }
        }
    </script>

<!-- Mobile Bottom Navigation -->
    <nav class="mobile-bottom-nav">
      <div class="mobile-nav-items">
        <a href="index.html" class="mobile-nav-item">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
            <polyline points="9 22 9 12 15 12 15 22"></polyline>
          </svg>
          <span>Home</span>
        </a>
        <a href="#" class="mobile-nav-item" onclick="event.preventDefault(); openCategoriesModal();">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <rect x="3" y="3" width="7" height="7"></rect>
            <rect x="14" y="3" width="7" height="7"></rect>
            <rect x="14" y="14" width="7" height="7"></rect>
            <rect x="3" y="14" width="7" height="7"></rect>
          </svg>
          <span>Categories</span>
        </a>
        <a href="wishlist.html" class="mobile-nav-item">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
          </svg>
          <span>Wishlist</span>
        </a>
        <a href="cart.html" class="mobile-nav-item">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <circle cx="9" cy="21" r="1"></circle>
            <circle cx="20" cy="21" r="1"></circle>
            <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
          </svg>
          <span>Cart</span>
          <span class="mobile-nav-badge cart-count">0</span>
        </a>
        <a href="login.html" class="mobile-nav-item" id="mobileAccountBtn">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor">
            <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
            <circle cx="12" cy="7" r="4"></circle>
          </svg>
          <span>Account</span>
        </a>
      </div>
    </nav>

        <!-- Categories Modal (Mobile) -->
    <div class="categories-modal" id="categoriesModal">
      <div class="modal-overlay" onclick="closeCategoriesModal()"></div>
      <div class="modal-content-categories">
        <div class="modal-header">
          <h3>Categories</h3>
          <button class="modal-close-btn" onclick="closeCategoriesModal()">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>
        <div class="categories-grid-modal">
          <!-- Everyday Elegance -->
          <a href="everyday-elegance.html" class="category-card-modal">
            <img src="assets/images/everyday-elegance.jpg" alt="Everyday Elegance" class="category-bg-modal">
            <div class="category-overlay-modal"></div>
            <div class="category-content-modal">
              <h4>Everyday<br>Elegance</h4>
            </div>
          </a>
          
          <!-- Elite Luxury -->
          <a href="elite-luxury.html" class="category-card-modal">
            <img src="assets/images/elite-luxury.png" alt="Elite Luxury" class="category-bg-modal">
            <div class="category-overlay-modal"></div>
            <div class="category-content-modal">
              <h4>Elite<br>Luxury</h4>
            </div>
          </a>
          
          <!-- Exclusive Collections -->
          <a href="exclusive-collections.html" class="category-card-modal">
            <img src="assets/images/exclusive-collections.png" alt="Exclusive Collections" class="category-bg-modal">
            <div class="category-overlay-modal"></div>
            <div class="category-content-modal">
              <h4>Exclusive<br>Collections</h4>
            </div>
          </a>
          
          <!-- Premium Accessories -->
          <a href="premium-accessories.html" class="category-card-modal">
            <div class="category-bg-modal accessories-bg">
              <div class="icon-pattern"></div>
            </div>
            <div class="category-content-modal dark-text">
              <h4>Premium<br>Accessories</h4>
            </div>
          </a>
        </div>
      </div>
    </div>


    <!-- Floating WhatsApp Button -->
    <a href="https://wa.me/8801604098325" class="floating-whatsapp" target="_blank" rel="noopener noreferrer">
      <div class="floating-whatsapp-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" width="28px" height="28px">
          <path fill="#fff" d="M4.868,43.303l2.694-9.835C5.9,30.59,5.026,27.324,5.027,23.979C5.032,13.514,13.548,5,24.014,5c5.079,0.002,9.845,1.979,13.43,5.566c3.584,3.588,5.558,8.356,5.556,13.428c-0.004,10.465-8.522,18.98-18.986,18.98c-3.191,0.002-6.314-0.8-9.113-2.338L4.868,43.303z" />
          <path fill="#fff" d="M4.868,43.303l2.694-9.835C5.9,30.59,5.026,27.324,5.027,23.979C5.032,13.514,13.548,5,24.014,5c5.079,0.002,9.845,1.979,13.43,5.566c3.584,3.588,5.558,8.356,5.556,13.428c-0.004,10.465-8.522,18.98-18.986,18.98c-3.191,0.002-6.314-0.8-9.113-2.338L4.868,43.303z" />
          <path fill="#cfd8dc" d="M24.014,5c5.079,0.002,9.845,1.979,13.43,5.566c3.584,3.588,5.558,8.356,5.556,13.428c-0.004,10.465-8.522,18.98-18.986,18.98c-3.191,0.002-6.314-0.8-9.113-2.338L4.868,43.303l2.694-9.835C5.9,30.59,5.026,27.324,5.027,23.979C5.032,13.514,13.548,5,24.014,5 M24.014,4.29C13.158,4.29,4.32,13.135,4.315,23.986c-0.001,3.612,0.972,6.996,2.643,9.902L4.156,43.844l10.19-2.67c2.81,1.55,5.99,2.373,9.244,2.373c10.856,0,19.694-8.845,19.699-19.696C43.301,13.298,34.87,4.29,24.014,4.29L24.014,4.29z" />
          <path fill="#40c351" d="M35.176,12.832c-2.98-2.982-6.941-4.625-11.163-4.627c-8.707,0-15.794,7.087-15.798,15.796c-0.001,2.785,0.727,5.503,2.111,7.901l-2.243,8.192l8.379-2.197c2.316,1.264,4.925,1.93,7.548,1.931h0.003c8.705,0,15.792-7.087,15.797-15.796C39.812,19.821,38.157,15.814,35.176,12.832z" />
          <path fill="#fff" fill-rule="evenodd" d="M19.268,16.045c-0.355-0.79-0.729-0.806-1.068-0.82c-0.277-0.012-0.593-0.011-0.909-0.011c-0.316,0-0.83,0.119-1.265,0.594c-0.435,0.475-1.661,1.622-1.661,3.956c0,2.334,1.7,4.59,1.937,4.906c0.237,0.316,3.282,5.259,8.104,7.161c4.007,1.58,4.823,1.266,5.693,1.187c0.87-0.079,2.807-1.147,3.202-2.255c0.395-1.108,0.395-2.057,0.277-2.255c-0.119-0.198-0.435-0.316-0.909-0.554s-2.807-1.385-3.242-1.543c-0.435-0.158-0.751-0.237-1.068,0.238c-0.316,0.474-1.225,1.543-1.502,1.859c-0.277,0.317-0.554,0.357-1.028,0.119c-0.474-0.238-2.002-0.738-3.815-2.354c-1.41-1.257-2.362-2.81-2.639-3.285c-0.277-0.474-0.03-0.731+0.208-0.968c0.213-0.213,0.474-0.554,0.712-0.831c0.237-0.277,0.316-0.475,0.474-0.791c0.158-0.317,0.079-0.594-0.04-0.831C20.612,19.329,19.69,16.983,19.268,16.045z" clip-rule="evenodd" />
        </svg>
      </div>
      <div class="floating-whatsapp-text">
        <span class="floating-whatsapp-label">Chat with us</span>
        <span class="floating-whatsapp-number">+880 1604-098325</span>
      </div>
    </a>

</body>
</html>
